<!doctype html>
<html lang="en">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
  <script type="module" src="../embed-api.js"></script>
  <link rel="stylesheet" href="../styles.css">
  <head>
    <title>Untitled</title>
  </head>
  <body>
    <div class="container">
    <root><div><h1 id="data-source" toclevel="1" tocentry="yes"></h1><p>The general idea of loading a spreadsheet into a table is straightforward: each cell of the spreadsheet corresponds to a cell of the table.  However, spreadsheet files (such as Google Sheets or .csv files) store their data in a serialized format, and loading the file must convert from that representation back into useful Pyret data types.  Moreover, Pyret tables expect each of their columns to be homogeneous, but there is nothing enforcing that restriction on arbitrary spreadsheet files.</p><p>Accordingly, Pyret exposes a <tt class="pyretexpr">CellContent</tt> data type to record what type it thinks each cell contains, and a <tt class="pyretexpr">Sanitizer</tt> to allow enforcing a uniform type over all values in a column.  These two notions are used by the <a href="trove/gdrive-sheets.html#gdrive-sheets"></a> library to convert Google Sheets files into Pyret <tt class="pyretexpr">Tabletables</tt>s.  A similar library could be written to use these two types to load tables from .csv files or other data sources.</p><h2 id="The-CellContent-Type" toclevel="2" tocentry="yes">The CellContent Type</h2><pre class="pyret-display"><span>data CellContent&lt;A&gt;:</span>
<div><tt>   | <span>| c-empty</span></tt>
<tt>   | <span>c-str(<span>s :: String</span>)</span></tt>
<tt>   | <span>c-num(<span>n :: Number</span>)</span></tt>
<tt>   | <span>c-bool(<span>b :: Boolean</span>)</span></tt>
<tt>   | <span>c-custom(<span>datum :: A</span>)</span></tt></div><tt>end</tt></pre><div class="insetpara"><div><p><span><a name="c-empty-79"></a></span></p><div class="pyret-display">c-empty :: <span>CellContent&lt;<span>A</span>&gt;</span></div></div><div><p><span><a name="c-str-80"></a></span></p><div class="pyret-display">c-str :: <span>(n :: String)</span> -&gt; <span>CellContent&lt;<span>a</span>&gt;</span></div><p></p></div><div><p><span><a name="c-num-81"></a></span></p><div class="pyret-display">c-num :: <span>(s :: Number)</span> -&gt; <span>CellContent&lt;<span>a</span>&gt;</span></div><p></p></div><div><p><span><a name="c-bool-82"></a></span></p><div class="pyret-display">c-bool :: <span>(b :: Boolean)</span> -&gt; <span>CellContent&lt;<span>a</span>&gt;</span></div><p></p></div><div><p><span><a name="c-custom-83"></a></span></p><div class="pyret-display">c-custom :: <span>(datum :: A)</span> -&gt; <span>CellContent&lt;<span>A</span>&gt;</span></div><p></p></div><p>  </p><div><pre class="pyret-display">is-c-empty :: </pre></div><p>  </p><div><pre class="pyret-display">is-c-str :: </pre></div><p>  </p><div><pre class="pyret-display">is-c-num :: </pre></div><p>  </p><div><pre class="pyret-display">is-c-bool :: </pre></div><p>  </p><div><pre class="pyret-display">is-c-custom :: </pre></div><p>This datatype describes Pyret’s</p></div><h2 id="Sanitizers" toclevel="2" tocentry="yes">Sanitizers</h2><div><div class="pyret-display">Sanitizer&lt;A, B&gt;</div><p><span><a name="Sanitizer&lt;A,-B&gt;-84"></a></span>A <tt class="pyretexpr">Sanitizer&lt;A, B&gt;</tt> is a function with signature <tt class="pyretexpr">(</tt><tt class="pyretexpr">CellContent</tt><tt class="pyretexpr">&lt;A&gt;, </tt><a href="UnDeFiNeD"></a><tt class="pyretexpr">,</tt><a href="UnDeFiNeD"></a><tt class="pyretexpr"> -&gt; B</tt><tt class="pyretexpr">)</tt>.  It takes in the contents of a cell, as well as the coordinates (column name, as given by the <a href="builtin/tables.html#s:tables:loading"><tt class="pyretexpr">load-table</tt>   header</a>, and zero-indexed row number) of that cell, and attempts to parse the contents of that cell to a value of the intended Pyret type.  If a cell’s contents cannot be parsed, the sanitizer may raise an error explaining the problem.</p></div><h3 id="Pre-defined-sanitizers" toclevel="3" tocentry="yes">Pre-defined sanitizers</h3><div><pre class="pyret-display">string-sanitizer :: <span>(<span>x :: </span>, <span>col :: </span>, <span>row :: </span>)</span></pre></div><p>This sanitizer tries to convert <tt class="pyretexpr">CellContent</tt>s containing anything to a <a href="UnDeFiNeD"></a>, by calling <a href="UnDeFiNeD"></a> on it.</p><div><pre class="pyret-display">num-sanitizer :: <span>(<span>x :: </span>, <span>col :: </span>, <span>row :: </span>)</span></pre></div><p>This sanitizer tries to convert <tt class="pyretexpr">CellContent</tt>s containing numbers, strings, or booleans to a <a href="UnDeFiNeD"></a>.  Strings are attempted to be parsed. True and false convert to 1 and 0 respectively.  Any other values are rejected, including blank cells.</p><div><pre class="pyret-display">bool-sanitizer :: <span>(<span>x :: </span>, <span>col :: </span>, <span>row :: </span>)</span></pre></div><p>This sanitizer tries to convert <tt class="pyretexpr">CellContent</tt>s containing numbers, strings, or booleans to a <a href="UnDeFiNeD"></a>.  0 and 1 convert to <tt class="pyretexpr">false</tt> and <tt class="pyretexpr">true</tt> respectively.  The (case-insensitive) strings <tt class="pyretexpr">“true”</tt> and <tt class="pyretexpr">“false”</tt> convert appropriately.  Any other values are rejected, including blank cells.</p><div><pre class="pyret-display">strict-num-sanitizer :: <span>(<span>x :: </span>, <span>col :: </span>, <span>row :: </span>)</span></pre></div><p>This sanitizer tries to convert <tt class="pyretexpr">CellContent</tt>s containing strings or numbers to a <a href="UnDeFiNeD"></a>.  Strings are attempted to be parsed.  Any other values are rejected, including blank cells.</p><div><pre class="pyret-display">strings-only :: <span>(<span>x :: </span>, <span>col :: </span>, <span>row :: </span>)</span></pre></div><p>This sanitizer accepts <tt class="pyretexpr">CellContent</tt>s containing strings only, and rejects all other values, including blank cells.</p><div><pre class="pyret-display">booleans-only :: <span>(<span>x :: </span>, <span>col :: </span>, <span>row :: </span>)</span></pre></div><p>This sanitizer accepts <tt class="pyretexpr">CellContent</tt>s containing booleans only, and rejects all other values, including blank cells.</p><div><pre class="pyret-display">numbers-only :: <span>(<span>x :: </span>, <span>col :: </span>, <span>row :: </span>)</span></pre></div><p>This sanitizer accepts <tt class="pyretexpr">CellContent</tt>s containing numbers only, and rejects all other values, including blank cells.</p><div><pre class="pyret-display">empty-only :: <span>(<span>x :: </span>, <span>col :: </span>, <span>row :: </span>)</span></pre></div><p>This sanitizer accepts <tt class="pyretexpr">CellContent</tt>s containing blank cells only, and rejects all other values.</p><div><pre class="pyret-display">option-sanitizer :: <span>(<span>value-sanitizer :: </span>)</span></pre></div><p>This higher-order sanitizer takes in another sanitizer that does not expect to be given blank cells, and produces a new sanitizer that can accept them.  Blank cells are converted to <tt class="pyretexpr">noneoption</tt>, while valid non-blank cells are converted to a <tt class="pyretexpr">someoption</tt> value containing the converted contents of the cell.  Values rejected by the <tt class="pyretexpr">value-sanitizer</tt> are rejected by this sanitizer as well.</p><p>This sanitizer is useful for handling incomplete data that might contain blank values; a subsequent processing step could filter out the <tt class="pyretexpr">noneoption</tt> values.</p></div></root>
    <hr/>
    The current page is trove/data-source.html.
    The previous page is <a href = "../builtin/raw-arrays.html">../builtin/raw-arrays.html</a>.
    The next page is <a href = "../trove/srcloc.html">../trove/srcloc.html</a>.
    </div>
  </body>
</html>