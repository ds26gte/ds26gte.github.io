<!doctype html>
<html lang="en">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
  <script type="module" src="../embed-api.js"></script>
  <script src="../codemirror.js"></script>
  <script src="../runmode.js"></script>
  <script src="../pyret.js"></script>
  <script src="../hilite.js"></script>
  <link rel="stylesheet" type="text/css" href="../codemirror.css" title="default"/>
  <link rel="stylesheet" type="text/css" href="../pyret.css" title="default"/>
  <link rel="stylesheet" type="text/css" href="../styles.css" title="default"/>
  <head>
    <title>gdrive-sheets</title>
  </head>
  <body>
    <div class="container">
    <root><div><h1 id="gdrive-sheets" toclevel="1" tocentry="yes">gdrive-sheets</h1><div><p>Usage:</p><pre class="pyret-highlight">include gdrive-sheets</pre><pre class="pyret-highlight">import gdrive-sheets as ...</pre></div><h2 id="The-Spreadsheet-Type" toclevel="2" tocentry="yes">The Spreadsheet Type</h2><div><p><span><a name="Spreadsheet"></a></span></p><pre class="pyret-display">Spreadsheet</pre><p><a href="../trove/gdrive-sheets.html#Spreadsheet"><span class="pyret-highlight"><tt class="pyretexpr">Spreadsheet</tt></span></a>s represent a connection to a Google Sheets document. These spreadsheets are primarily used to create a <span class="pyret-highlight"><tt class="pyretexpr">Table</tt></span>, using the <a href="../builtin/tables.html#s:tables:loading"><span class="pyret-highlight"><tt class="pyretexpr">load-table:</tt></span>  syntax</a> and the <a href="../trove/gdrive-sheets.html#.sheet-by-name">.sheet-by-name</a> method below.  However, the spreadsheet values themselves can be useful to <i>create or modify</i> Google Sheets documents, as well.</p></div><h2 id="The-Worksheet-Type" toclevel="2" tocentry="yes">The Worksheet Type</h2><div><p><span><a name="Worksheet"></a></span></p><pre class="pyret-display">Worksheet</pre><p><a href="../trove/gdrive-sheets.html#Worksheet"><span class="pyret-highlight"><tt class="pyretexpr">Worksheet</tt></span></a>s represent individual worksheets within a Google Sheets document.  Nothing can be done directly with worksheets in Pyret, except to load them into tables.</p></div><h2 id="Spreadsheet-Functions" toclevel="2" tocentry="yes">Spreadsheet Functions</h2><div><p><span><a name="create-spreadsheet"></a></span></p><pre class="pyret-display"><a href="../trove/gdrive-sheets.html#create-spreadsheet">create-spreadsheet</a> :: <span>(<span><span class="pyret-content">name :: <a href="../trove/globals.html#String">String</a></span></span>) -&gt; <a href="../trove/gdrive-sheets.html#Spreadsheet">Spreadsheet</a></span></pre><p>Creates a new Google Sheets document with the given name, in the currently logged-in user’s Google Documents account.  The newly created file will not yet have any worksheets in it.</p></div><div><p><span><a name="my-spreadsheet"></a></span></p><pre class="pyret-display"><a href="../trove/gdrive-sheets.html#my-spreadsheet">my-spreadsheet</a> :: <span>(<span><span class="pyret-content">name :: <a href="../trove/globals.html#String">String</a></span></span>) -&gt; <a href="../trove/gdrive-sheets.html#Spreadsheet">Spreadsheet</a></span></pre><p>Accesses a private Google Sheets file and produces a <a href="../trove/gdrive-sheets.html#Spreadsheet"><span class="pyret-highlight"><tt class="pyretexpr">Spreadsheet</tt></span></a>. If the file is ever shared, change code that uses this function to instead call <a href="../trove/gdrive-sheets.html#load-spreadsheet"><span class="pyret-highlight"><tt class="pyretexpr">load-spreadsheet</tt></span></a> below.</p></div><div><p><span><a name="load-spreadsheet"></a></span></p><pre class="pyret-display"><a href="../trove/gdrive-sheets.html#load-spreadsheet">load-spreadsheet</a> :: <span>(<span><span class="pyret-content">id :: <a href="../trove/globals.html#String">String</a></span></span>) -&gt; <a href="../trove/gdrive-sheets.html#Spreadsheet">Spreadsheet</a></span></pre><p>  Accesses a publicly shared Google sheets file and produces a   <a href="../trove/gdrive-sheets.html#Spreadsheet"><span class="pyret-highlight"><tt class="pyretexpr">Spreadsheet</tt></span></a>.  This function is more commonly used than   <a href="../trove/gdrive-sheets.html#my-spreadsheet"><span class="pyret-highlight"><tt class="pyretexpr">my-spreadsheet</tt></span></a>.</p><p>Accepts either the ID of a Google Sheets file, or the full URL. So, for example, these two uses access the same sheet:</p><pre class="pyret-highlight">animal-sheet1 = load-spreadsheet("https://docs.google.com/spreadsheets/d/1VeR2_bhpLvnRUZslmCAcSRKfZWs_5RNVujtZgEl6umA/")
animal-sheet2 = load-spreadsheet("1VeR2_bhpLvnRUZslmCAcSRKfZWs_5RNVujtZgEl6umA")</pre></div><div><p><span><a name="open-sheet"></a></span></p><pre class="pyret-display"><a href="../trove/gdrive-sheets.html#open-sheet">open-sheet</a> :: <span>(<span><span class="pyret-content">spreadsheet :: <a href="../trove/gdrive-sheets.html#Spreadsheet">Spreadsheet</a></span>, <span class="pyret-content">name :: <a href="../trove/globals.html#String">String</a></span>, <span class="pyret-content">skipHeaders :: <a href="../trove/globals.html#Boolean">Boolean</a></span></span>) -&gt; <a href="../trove/gdrive-sheets.html#Worksheet">Worksheet</a></span></pre><p>Obtains the <a href="../trove/gdrive-sheets.html#Worksheet"><span class="pyret-highlight"><tt class="pyretexpr">Worksheet</tt></span></a> of the given name from the given <a href="../trove/gdrive-sheets.html#Spreadsheet"><span class="pyret-highlight"><tt class="pyretexpr">Spreadsheet</tt></span></a>.  Since worksheets commonly contain a <i>header row</i> with names describing the contents of each column, the last parameter tells Pyret whether to ignore the first row when extracted the data from the worksheet into a table.  This function is a shortcut for using <a href="../trove/gdrive-sheets.html#load-spreadsheet"><span class="pyret-highlight"><tt class="pyretexpr">load-spreadsheet</tt></span></a> followed by the <a href="../trove/gdrive-sheets.html#.sheet-by-name">.sheet-by-name</a> method.  See <a href="../builtin/tables.html#s:tables:loading">Loading Tables</a> for more information.</p></div><div><p><span><a name="open-sheet-by-index"></a></span></p><pre class="pyret-display"><a href="../trove/gdrive-sheets.html#open-sheet-by-index">open-sheet-by-index</a> :: <span>(<span><span class="pyret-content">spreadsheet :: <a href="../trove/gdrive-sheets.html#Spreadsheet">Spreadsheet</a></span>, <span class="pyret-content">index :: <a href="../trove/globals.html#Number">Number</a></span>, <span class="pyret-content">skipHeaders :: <a href="../trove/globals.html#Boolean">Boolean</a></span></span>) -&gt; <a href="../trove/gdrive-sheets.html#Worksheet">Worksheet</a></span></pre><p>Much like <a href="../trove/gdrive-sheets.html#open-sheet"><span class="pyret-highlight"><tt class="pyretexpr">open-sheet</tt></span></a>, except it selects the worksheet by its index within the file, with 0 being the first worksheet in the file.  This function is a shortcut for using <a href="../trove/gdrive-sheets.html#load-spreadsheet"><span class="pyret-highlight"><tt class="pyretexpr">load-spreadsheet</tt></span></a> followed by the <a href="../trove/gdrive-sheets.html#.sheet-by-index">.sheet-by-index</a> method.</p></div><h2 id="Spreadsheet-Methods" toclevel="2" tocentry="yes">Spreadsheet Methods</h2><div><p><span><a name=".sheet-names"></a></span></p><pre class="pyret-display">.sheet-names :: <span>() -&gt; <span><a href="../trove/lists.html#List">List</a>&lt;<span><a href="../trove/globals.html#String">String</a></span>&gt;</span></span></pre></div><p>Returns the list of worksheet names in this <a href="../trove/gdrive-sheets.html#Spreadsheet"><span class="pyret-highlight"><tt class="pyretexpr">Spreadsheet</tt></span></a>, in order from left to right.  The names in this list can be used with <a href="../trove/gdrive-sheets.html#.sheet-by-name">.sheet-by-name</a>, and the indices of names in this list can be used with <a href="../trove/gdrive-sheets.html#.sheet-by-index">.sheet-by-index</a>.</p><div><p><span><a name=".sheet-by-name"></a></span></p><pre class="pyret-display">.sheet-by-name :: <span>(<span><span class="pyret-content">name :: <a href="../trove/globals.html#String">String</a></span>, <span class="pyret-content">skipHeaders :: <a href="../trove/globals.html#Boolean">Boolean</a></span></span>) -&gt; <a href="../trove/gdrive-sheets.html#Worksheet">Worksheet</a></span></pre></div><p>Obtains a <a href="../trove/gdrive-sheets.html#Worksheet"><span class="pyret-highlight"><tt class="pyretexpr">Worksheet</tt></span></a> of the given name from the given worksheet.  The <span class="pyret-highlight"><tt class="pyretexpr">skipHeaders</tt></span> argument specifies whether to ignore the first row of the sheet when extracting its contents as a table (i.e. to treat the first row as a header row rather than a data row).</p><div><p><span><a name=".sheet-by-index"></a></span></p><pre class="pyret-display">.sheet-by-index :: <span>(<span><span class="pyret-content">index :: <a href="../trove/globals.html#Number">Number</a></span>, <span class="pyret-content">skipHeaders :: <a href="../trove/globals.html#Boolean">Boolean</a></span></span>) -&gt; <a href="../trove/gdrive-sheets.html#Worksheet">Worksheet</a></span></pre></div><p>Obtains a <a href="../trove/gdrive-sheets.html#Worksheet"><span class="pyret-highlight"><tt class="pyretexpr">Worksheet</tt></span></a> of the given index (counting from 0) from the given worksheet.  The <span class="pyret-highlight"><tt class="pyretexpr">skipHeaders</tt></span> argument specifies whether to ignore the first row of the sheet when extracting its contents as a table (i.e. to treat the first row as a header row rather than a data row).</p></div></root>
    <hr/>
    <!-- The current page is trove/gdrive-sheets.html. -->
    <a class="floatleft" href="../builtin/tables.html">⏴⏴⏴</a>
    <a class="floatright" href="../trove/csv.html">⏵⏵⏵</a>
    </div>
  </body>
</html>